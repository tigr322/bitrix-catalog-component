<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____2051364471']= array(base64_decode('a'.'XNf'.'c3Ry'.'aW5n'),base64_decode('c3'.'R'.'ydG9'.'sb3dl'.'cg='.'='),base64_decode(''.'aX'.'NfYXJyYXk='),base64_decode('aXNfc3'.'RyaW5n'),base64_decode(''.'Z'.'3pkZ'.'WNv'.'Z'.'GU'.'='),base64_decode(''.'YmFzZTY0X2'.'RlY29kZQ=='),base64_decode('dXJsZGVjb2Rl'),base64_decode(''.'YX'.'JyYXlf'.'cmV'.'2ZX'.'Jz'.'ZQ'.'=='),base64_decode('Z3plbm'.'N'.'vZ'.'GU='),base64_decode('YmFzZTY0X2VuY'.'2'.'9kZ'.'Q='.'='),base64_decode(''.'dXJ'.'sZW'.'5jb2'.'Rl'),base64_decode(''.'YmluM'.'mhleA=='),base64_decode('aXNfY'.'X'.'Jy'.'YXk='),base64_decode('c3R'.'ydG9'.'s'.'b3dlcg=='),base64_decode('aXNfY'.'XJyYXk='),base64_decode(''.'am'.'9pbg=='),base64_decode('Zm5t'.'YXRjaA=='),base64_decode('cmF3'.'dXJsZ'.'GVjb2'.'Rl'),base64_decode(''.'c3'.'Vi'.'c'.'3Ry'),base64_decode('c3Vi'.'c3'.'Ry'),base64_decode(''.'c3RyX3JlcGxhY2U='),base64_decode('cHJlZ19xdW9'.'0ZQ'.'=='),base64_decode('c'.'HJlZ19tYXRjaA=='));if(!function_exists(__NAMESPACE__.'\\___1540612296')){function ___1540612296($_1628203837){static $_1473393201= false; if($_1473393201 == false) $_1473393201=array(''.'YWN0'.'aW9u','a'.'W5'.'0dmFs','cGF0aA'.'==','Y2'.'9udG'.'V'.'4dA==','a2V5'.'c'.'w==','c'.'HJvY2'.'Vz'.'cw==','ZW5'.'jb'.'2'.'R'.'pb'.'mc=',''.'c'.'HJlZ'.'19yZXBs'.'Y'.'WNl','c'.'GF0aA'.'='.'=',''.'Y2'.'9udGV4dA'.'='.'=','a2V'.'5cw==','cH'.'JvY2'.'Vzcw==','ZW5jb2Rpb'.'m'.'c=','cGF0dGVybg==','cHJl'.'Z'.'19'.'tYX'.'RjaA==','cGF0aA==',''.'Y29udGV4d'.'A==','a2V5'.'cw==','cHJvY2Vzc'.'w==','ZW5jb2Rpb'.'m'.'c'.'=','cGF0dGVybg'.'==','cG9zdF9hY3Rp'.'b'.'24=','Y'.'2'.'hlY2tf'.'Y3'.'Ny'.'Zg==','cGF0aA==','Y29udGV4dA='.'=','a2V'.'5'.'c'.'w='.'=','cHJvY2Vz'.'cw==',''.'ZW5jb2Rp'.'bm'.'c=','cGF0dG'.'Vyb'.'g==','YW'.'N0'.'a'.'W'.'9u','Y'.'WN'.'0aW9u','YWN0aW9u','YW'.'N'.'0aW9u',''.'Y'.'WN0aW9'.'u','YW'.'N'.'0a'.'W9'.'u','cG9'.'zdF'.'9'.'hY3Rpb2'.'4=','Z'.'W5jb'.'2Rpbmc=','Z'.'W5j'.'b2Rpb'.'mc=',''.'ZW5j'.'b2'.'Rpbmc=','ZW5'.'jb'.'2R'.'pbmc=',''.'Z'.'W5jb'.'2R'.'pb'.'mc'.'=','ZW5jb2Rpbmc=','Z3o=','Y'.'mFzZTY0','dXJ'.'s',''.'aG'.'V'.'4','Lg==','Lw==','a'.'W5'.'kZ'.'XgucG'.'hw','L'.'2luZG'.'V'.'4LnB'.'ocA'.'='.'=','U'.'0NSSVBUX05BTUU=','L2l'.'u'.'ZGV4'.'L'.'nBocA='.'=','U0N'.'SSV'.'BUX05BTU'.'U=','U0NS'.'S'.'VBUX0'.'5BTU'.'U=',''.'U'.'0NSSVBUX05BTUU=','fg==','fl'.'4'.'=','fg==','XH4=','JH4'.'=');return base64_decode($_1473393201[$_1628203837]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_903514145; protected $_870635266; protected $_888165650; protected $_1834771556; protected $_935070937; public static function make(array $_1834047716):?static{ $_1834047716= static::prepareRuleParameters($_1834047716); return match($_1834047716[___1540612296(0)]){ ___1540612296(1) => new IntvalRule( $_1834047716[___1540612296(2)], $_1834047716[___1540612296(3)], $_1834047716[___1540612296(4)], $_1834047716[___1540612296(5)], $_1834047716[___1540612296(6)]), ___1540612296(7) => new PregReplaceRule( $_1834047716[___1540612296(8)], $_1834047716[___1540612296(9)], $_1834047716[___1540612296(10)], $_1834047716[___1540612296(11)], $_1834047716[___1540612296(12)], $_1834047716[___1540612296(13)]), ___1540612296(14) => new PregMatchRule( $_1834047716[___1540612296(15)], $_1834047716[___1540612296(16)], $_1834047716[___1540612296(17)], $_1834047716[___1540612296(18)], $_1834047716[___1540612296(19)], $_1834047716[___1540612296(20)], $_1834047716[___1540612296(21)]), ___1540612296(22) => new CsrfRule( $_1834047716[___1540612296(23)], $_1834047716[___1540612296(24)], $_1834047716[___1540612296(25)], $_1834047716[___1540612296(26)], $_1834047716[___1540612296(27)], $_1834047716[___1540612296(28)],), default => null,};} protected static function prepareRuleParameters(array $_14571471): array{ if($GLOBALS['____2051364471'][0]($_14571471[___1540612296(29)])){ $_14571471[___1540612296(30)]= $GLOBALS['____2051364471'][1]($_14571471[___1540612296(31)]);} elseif($GLOBALS['____2051364471'][2]($_14571471[___1540612296(32)])){ $_193988339= $_14571471[___1540612296(33)]; $_14571471[___1540612296(34)]= $_193988339[(762-2*381)]; $_14571471[___1540612296(35)]= $_193988339[round(0+1)];} $_14571471[___1540612296(36)]=!empty($_14571471[___1540612296(37)])? $_14571471[___1540612296(38)]:[]; if($GLOBALS['____2051364471'][3]($_14571471[___1540612296(39)])){ $_14571471[___1540612296(40)]=[$_14571471[___1540612296(41)]];} return $_14571471;}  public function __construct($_903514145, $_870635266, $_888165650, $_1834771556, $_935070937){ $this->_903514145= $_903514145; $this->_870635266= $this->castContext($_870635266); $this->_888165650= $this->castKeys($_888165650); $this->_1834771556= $_1834771556; $this->_935070937= $_935070937;} public function evaluateValue($_151461419){ if(!empty($this->_935070937)){ foreach($this->_935070937 as $_440361596){ $_151461419= match($_440361596){ 'gz' => $GLOBALS['____2051364471'][4]($_151461419), 'base64' => $GLOBALS['____2051364471'][5]($_151461419), 'url' => $GLOBALS['____2051364471'][6]($_151461419), 'hex' => hex2bin($_151461419)};}} $_1865942884= $this->evaluate($_151461419); if(!empty($this->_935070937) && $_1865942884 instanceof ModifyResult){ $_964278978= $_1865942884->getCleanValue(); foreach($GLOBALS['____2051364471'][7]($this->_935070937) as $_440361596){ $_964278978= match($_440361596){ ___1540612296(42) => $GLOBALS['____2051364471'][8]($_964278978), ___1540612296(43) => $GLOBALS['____2051364471'][9]($_964278978), ___1540612296(44) => $GLOBALS['____2051364471'][10]($_964278978), ___1540612296(45) => $GLOBALS['____2051364471'][11]($_964278978)};} $_1865942884= new ModifyResult($_964278978);} return $_1865942884;} abstract public function evaluate($_151461419); protected function castContext($_870635266){ if(!$GLOBALS['____2051364471'][12]($_870635266)){ $_870635266=[$_870635266];} foreach($_870635266 as $_17587715 => $_1039175514){ $_870635266[$_17587715]= $GLOBALS['____2051364471'][13]($_1039175514);} return $_870635266;} protected function castKeys($_888165650){ if(!$GLOBALS['____2051364471'][14]($_888165650)){ $_888165650=[$_888165650];} return $_888165650;} public function matchKey(array $_63504886): bool{ $_63504886= $GLOBALS['____2051364471'][15](___1540612296(46), $_63504886); foreach($this->_888165650 as $_526093909){   if($GLOBALS['____2051364471'][16]($_526093909, $_63504886)){ return true;}} return false;}  public function matchPath($_1541946359){ if($this->_903514145 === '*'){ return true;}  $_1320482197= new Uri($_1541946359); $_906640460= $_1320482197->getPath(); $_906640460= $GLOBALS['____2051364471'][17]($_906640460);      if(str_ends_with($_906640460, ___1540612296(47))){ $_906640460 .= ___1540612296(48);} $_906640460= Path::normalize($_906640460);  $_105123297[]= $_906640460; if(str_ends_with($_906640460, ___1540612296(49))){ $_105123297[]= $GLOBALS['____2051364471'][18]($_906640460,(142*2-284),-round(0+9));} elseif(str_ends_with($_SERVER[___1540612296(50)], ___1540612296(51))){ $_105123297[]= $GLOBALS['____2051364471'][19]($_SERVER[___1540612296(52)],(892-2*446),-round(0+9));} if($_906640460 !== $_SERVER[___1540612296(53)]){ $_105123297[]= $_SERVER[___1540612296(54)];}  if(str_starts_with($this->_903514145, ___1540612296(55))){ $_213296670= $this->_903514145;} else{ $_213296670= ___1540612296(56). $GLOBALS['____2051364471'][20](___1540612296(57), ___1540612296(58), $GLOBALS['____2051364471'][21]($this->_903514145)). ___1540612296(59);} foreach($_105123297 as $_1707843813){ if($this->_903514145 === $_1707843813 || $GLOBALS['____2051364471'][22]($_213296670, $_1707843813)){ return true;}} return false;}  public function getPath(){ return $this->_903514145;}  public function getContext(){ return $this->_870635266;}  public function getKeys(){ return $this->_888165650;}  public function getProcess(){ return $this->_1834771556;}}?>